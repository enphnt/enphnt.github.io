"use strict";(self.webpackChunknathan_phennel_website=self.webpackChunknathan_phennel_website||[]).push([[780],{7592:function(e,t,n){var a=n(1151),l=n(7294);function r(e){const t=Object.assign({p:"p",code:"code",h3:"h3",pre:"pre",ol:"ol",li:"li",h4:"h4",h1:"h1"},(0,a.ah)(),e.components);return l.createElement(l.Fragment,null,l.createElement(t.p,null,"First off, I'm using such an old of a version of ",l.createElement(t.code,null,"gatsy")," that I can't currently leverage gatsby's newest features. I'll need to upgrade to minimum version of ",l.createElement(t.code,null,"gatsby@4.19.0")," in order to use SEO tooling."),"\n",l.createElement(t.p,null,"This post is just my notes from performing the upgrade. I'm dog sitting this weekend so will be doing this with my partner, Pickle, today. Pickle is an extremely needy dachshund. She needs pats and stimulation constantly much like this blog needs posts and upgrades today."),"\n",l.createElement(t.h3,null,"v1 to v2 upgrade"),"\n",l.createElement(t.p,null,"I'll try just setting package.json version to 2.0.0:"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,'  \n  "dependencies": {\n    "gatsby": "^2.0.0",\n  }\n\n')),"\n",l.createElement(t.p,null,"After running ",l.createElement(t.code,null,"npm i"),", I needed to update all the peers of gatsby to a higher version too. After doing that, ",l.createElement(t.code,null,"react")," and ",l.createElement(t.code,null,"react-dom")," packages were added because in v1 these were bundled inside gatsby but no longer are."),"\n",l.createElement(t.p,null,"I was able to finish the install of new packages and render the site successfully using my package script: ",l.createElement(t.code,null,"npm run develop")),"\n",l.createElement(t.p,null,"However, now I see massive layout issues and I will move on to restructuring my react components so that they no longer use the ",l.createElement(t.code,null,"layout.js")," as a root component."),"\n",l.createElement(t.p,null,"After the following steps, which are thankfully documented in the  ",l.createElement("a",{target:"_blank",href:"https://www.gatsbyjs.com/docs/reference/release-notes/migrating-from-v1-to-v2/"},"migration guide"),", I'm up and running again. Had to do the following steps."),"\n",l.createElement(t.ol,null,"\n",l.createElement(t.li,null,"Convert layout's children from render prop to normal prop (required)"),"\n",l.createElement(t.li,null,"Mv layouts/index.js to src/components/layout.js (optional, but recommended)"),"\n",l.createElement(t.li,null,"Import then wrap pages with layout component"),"\n",l.createElement(t.li,null,"Pass history, location, and match props to layout (didn't do this actually)"),"\n",l.createElement(t.li,null,"Change the query to use StaticQuery (now getting false pos warn about 'maxWidth' in query)"),"\n"),"\n",l.createElement(t.h4,null,"v2 Done"),"\n",l.createElement(t.p,null,"We made it. Things so far have remained straightforward. Next I'll continue upgrading to v4 now from v2."),"\n",l.createElement(t.h3,null,"v2 to v4 upgrade"),"\n",l.createElement(t.p,null,"For this migration, I skipped 3 altogether as I saw few breaking changes that would affect me. In fact, it looks like none! Even further migrating to v4 shows no apparent breaking changes i'll need to address."),"\n",l.createElement(t.p,null,"I updated the package.json to the latest release for v4 according to npm:"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,'\n    "gatsby": "4.25.2",\n\n')),"\n",l.createElement(t.p,null,"After that, I updated all the gatsby plugin and peers to their latest v4 versions (using npm versions page as my reference):"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,'    \n    "gatsby-plugin-catch-links": "^4.25.0",\n    "gatsby-plugin-react-helmet": "5.25.0",\n    "gatsby-source-filesystem": "^4.25.0",\n    "gatsby-transformer-remark": "^5.25.1",\n\n')),"\n",l.createElement(t.p,null,"Luckily, not too many packages."),"\n",l.createElement(t.p,null,"On installing, I faced nothing major except a few warnings. I ended up facing more issues when I tried to run ",l.createElement(t.code,null,"gatsby develop"),". Errors looked like:"),"\n",l.createElement("pre",{style:{height:140}},l.createElement(t.p,null,"failed Building production JavaScript and CSS bundles - 4.511s"),l.createElement(t.p,null,"ERROR #98124  WEBPACK"),l.createElement(t.p,null,"Generating JavaScript bundles failed"),l.createElement(t.p,null,"Can't resolve '@gatsbyjs/reach-router/lib/utils' in '/Users/nathanphennel/Projects/blog/.cache'"),l.createElement(t.p,null,"If you're trying to use a package make sure that '@gatsbyjs/reach-router/lib/utils' is installed. If you're trying to use a local\nfile make sure that the path is correct."),l.createElement(t.p,null,"File: .cache/find-path.js:1:0"),l.createElement(t.p,null,"ERROR #98124  WEBPACK"),l.createElement(t.p,null,"Generating JavaScript bundles failed"),l.createElement(t.p,null,"Can't resolve 'gatsby-react-router-scroll' in '/Users/nathanphennel/Projects/blog/.cache'"),l.createElement(t.p,null,"If you're trying to use a package make sure that 'gatsby-react-router-scroll' is installed. If you're trying to use a local file\nmake sure that the path is correct."),l.createElement(t.p,null,"File: .cache/gatsby-browser-entry.js:1:504"),l.createElement(t.p,null,"ERROR #98124  WEBPACK"),l.createElement(t.p,null,"Generating JavaScript bundles failed"),l.createElement(t.p,null,"Can't resolve 'gatsby-link' in '/Users/nathanphennel/Projects/blog/.cache'"),l.createElement(t.p,null,"If you're trying to use a package make sure that 'gatsby-link' is installed. If you're trying to use a local file make sure that\nthe path is correct."),l.createElement(t.p,null,"File: .cache/gatsby-browser-entry.js:1:565"),l.createElement(t.p,null,"ERROR #98124  WEBPACK"),l.createElement(t.p,null,"Generating JavaScript bundles failed"),l.createElement(t.p,null,"Can't resolve 'gatsby-script' in '/Users/nathanphennel/Projects/blog/.cache'"),l.createElement(t.p,null,"If you're trying to use a package make sure that 'gatsby-script' is installed. If you're trying to use a local file make sure that\nthe path is correct."),l.createElement(t.p,null,"File: .cache/gatsby-browser-entry.js:1:784"),l.createElement(t.p,null,"ERROR #98124  WEBPACK"),l.createElement(t.p,null,"Generating JavaScript bundles failed"),l.createElement(t.p,null,"Can't resolve '@gatsbyjs/reach-router' in '/Users/nathanphennel/Projects/blog/.cache/head'"),l.createElement(t.p,null,"If you're trying to use a package make sure that '@gatsbyjs/reach-router' is installed. If you're trying to use a local file make\nsure that the path is correct."),l.createElement(t.p,null,"File: .cache/head/head-export-handler-for-browser.js:1:1158"),l.createElement(t.p,null,"ERROR #98124  WEBPACK"),l.createElement(t.p,null,"Generating JavaScript bundles failed"),l.createElement(t.p,null,"Can't resolve '@gatsbyjs/reach-router' in '/Users/nathanphennel/Projects/blog/.cache'"),l.createElement(t.p,null,"If you're trying to use a package make sure that '@gatsbyjs/reach-router' is installed. If you're trying to use a local file make\nsure that the path is correct."),l.createElement(t.p,null,"File: .cache/navigation.js:1:332"),l.createElement(t.p,null,"ERROR #98124  WEBPACK"),l.createElement(t.p,null,"Generating JavaScript bundles failed"),l.createElement(t.p,null,"Can't resolve '@gatsbyjs/reach-router/lib/history' in '/Users/nathanphennel/Projects/blog/.cache'"),l.createElement(t.p,null,"If you're trying to use a package make sure that '@gatsbyjs/reach-router/lib/history' is installed. If you're trying to use a\nlocal file make sure that the path is correct."),l.createElement(t.p,null,"File: .cache/navigation.js:1:394"),l.createElement(t.p,null,"ERROR #98124  WEBPACK"),l.createElement(t.p,null,"Generating JavaScript bundles failed"),l.createElement(t.p,null,"Can't resolve 'gatsby-link' in '/Users/nathanphennel/Projects/blog/.cache'"),l.createElement(t.p,null,"If you're trying to use a package make sure that 'gatsby-link' is installed. If you're trying to use a local file make sure that\nthe path is correct."),l.createElement(t.p,null,"File: .cache/navigation.js:1:456"),l.createElement(t.p,null,"ERROR #98124  WEBPACK"),l.createElement(t.p,null,"Generating JavaScript bundles failed"),l.createElement(t.p,null,"Can't resolve '@gatsbyjs/reach-router' in '/Users/nathanphennel/Projects/blog/.cache'"),l.createElement(t.p,null,"If you're trying to use a package make sure that '@gatsbyjs/reach-router' is installed. If you're trying to use a local file make\nsure that the path is correct."),l.createElement(t.p,null,"File: .cache/production-app.js:1:153"),l.createElement(t.p,null,"ERROR #98124  WEBPACK"),l.createElement(t.p,null,"Generating JavaScript bundles failed"),l.createElement(t.p,null,"Can't resolve 'gatsby-react-router-scroll' in '/Users/nathanphennel/Projects/blog/.cache'"),l.createElement(t.p,null,"If you're trying to use a package make sure that 'gatsby-react-router-scroll' is installed. If you're trying to use a local file\nmake sure that the path is correct."),l.createElement(t.p,null,"File: .cache/production-app.js:1:226")),"\n",l.createElement(t.p,null,"To overcome these, I found that its necessary to add gatsby peer deps to the ",l.createElement(t.code,null,"package.json")," for some unknown reason. I saw there was a bit of chatter about deps issues on gatsby's github ",l.createElement("a",{target:"_blank",href:"https://github.com/gatsbyjs/gatsby/discussions/35313"},"issues"),". ",l.createElement("a",{target:"_blank",href:"https://github.com/gatsbyjs/gatsby/issues/25708"},"Here")," I saw I could just bypass issues with the transient deps and just specify compatible versions myself in the ",l.createElement(t.code,null,"package.json")," like so:"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,'"gatsby-link": "^4.25.0",\n"gatsby-react-router-scroll": "^5.25.0",\n"@gatsbyjs/reach-router": "1.3.9",\n"gatsby-script": "^1.10.0",\n')),"\n",l.createElement(t.p,null,"After this update, I ran the following:"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null," rm -rf node_modules/\n rm package-lock.json\n rm -rf .cache\n npm i\n npm run clean\n npm i\n npm run develop\n")),"\n",l.createElement(t.p,null,"Upon completely reseting all the deps for v4, things were back up and running. Only one small issue noticeable in the terminal remains when running ",l.createElement(t.code,null,"gatsby develop"),":"),"\n",l.createElement(t.pre,null,l.createElement(t.code,null,'warn Warning: there are unknown plugin options for "gatsby-source-filesystem": fastHash\nPlease open an issue at https://ghub.io/gatsby-source-filesystem if you believe this option is valid.\n')),"\n",l.createElement(t.p,null,"Turns out, this is now handled automatically by the plugin. I don't need to specify ",l.createElement(t.code,null,"fastHash")," for detecting changes to images any longer. Nice! Now I'm running with no noticeable issues and no major terminal warning."),"\n",l.createElement(t.h1,null,"Conclusion"),"\n",l.createElement(t.p,null,"Gatsby seems to have some growing pains but nothing out of the ordinary. In fact, the upgrade to v4 was surprisingly smooth. Next, i'll actually move on to implementing some of the SEO tools that gatsby has to offer and testing that things are working when I google myself."),"\n",l.createElement(t.p,null,"I'm now off to play with Pickle. Until next time."))}t.Z=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,a.ah)(),e.components);return t?l.createElement(t,e,l.createElement(r,e)):r(e)}},6950:function(e,t,n){n.r(t),n.d(t,{Head:function(){return i},default:function(){return u}});var a=n(7592),l=n(7294),r=n(8032),s=n(7144),o=n(9357);const c=e=>{let{data:t,children:n}=e;const a=(0,r.c)(t.mdx.frontmatter.hero_image);return l.createElement("div",{style:{margin:12}},l.createElement(s.Z,{pageTitle:t.mdx.frontmatter.title},l.createElement("a",{href:"/projects"}," ../Back to Projects"),l.createElement("p",null,t.mdx.frontmatter.date),a?l.createElement(l.Fragment,null,l.createElement(r.G,{image:a,alt:t.mdx.frontmatter.hero_image_alt}),l.createElement("p",null,"Photo Credit:"," ",l.createElement("a",{href:t.mdx.frontmatter.hero_image_credit_link},t.mdx.frontmatter.hero_image_credit_text))):null,n))},i=()=>l.createElement(o.Z,{title:"Super Cool Blog Posts"});function u(e){return l.createElement(c,e,l.createElement(a.Z,e))}},1151:function(e,t,n){n.d(t,{ah:function(){return r}});var a=n(7294);const l=a.createContext({});function r(e){const t=a.useContext(l);return a.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}}}]);
//# sourceMappingURL=component---src-pages-projects-mdx-frontmatter-slug-js-content-file-path-users-nathanphennel-projects-enphnt-github-io-blog-gatsby-upgrades-index-mdx-4a1c49d4620720254b3c.js.map